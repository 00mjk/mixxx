#!/bin/bash

#************************************************************************
# Qmake deps script
# version 0.2
# Copyright (c) 2003 Gianluca Romanin ( J_Zar )  <jayorama@users.sourceforge.net>
#************************************************************************


#************************************************************************
#
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.
#
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#
#  You should have received a copy of the GNU General Public License
#  along with this program; if not, write to the Free Software
#  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
#
#************************************************************************

# inserting blanks...
echo
echo "-------------------------------------------"

######################### Main stage
#
if   test "$1" = "--help" ;
then
	echo ""
	echo ""
	echo "Usage:  ./configure  [ options ] [ values ]"
	echo "Options:"
	echo "	-h, --help		stamp this message"
	echo "	--includedir		adds a path for dependency checking (max number allowed = 5)"
	echo "	--prefix		define the install directory prefix"
	echo ""
	echo "Examples:"
	echo "	./configure     --includedir  /usr/share/libx /home/liby"
	echo "		adds two paths to check dependencies:     /usr/share/libx  and /home/liby"
	echo ""
	echo ""
	exit
fi

if   test "$1" = "-h"  ;
then
	echo ""
	echo ""
	echo "Usage:  ./configure  [ options ] [ values ]"
	echo "Options:"
	echo "	-h, --help		stamp this message"
	echo "	--includedir		adds a path for dependency checking (max number allowed = 5)"
	echo "	--prefix		define the install directory prefix"
	echo ""
	echo "Examples:"
	echo "	./configure     --includedir  /usr/share/libx /home/liby"
	echo "		adds two paths to check dependencies:     /usr/share/libx  and /home/liby"
	echo ""
	echo ""
	exit
fi

# cleanup phase
rm -f configure.def

# global control
PREFIX_DEFINED_AT="-1"


# this code needs a great optimization.... ;-(
if test "$1" = "--includedir";
then
	if test "$#" = "1" ;
	then
		echo " Missing include parameters! "
		exit
	else

	if test "$2" = "--prefix";
	then
		echo " Missing include parameters! "
		exit
	else
		echo "PATH0 = $2" >> configure.def
	fi



	if test "$3" = "--prefix";
	then
		if test "$#" = "3" ;
		then
			echo " Missing parameters! "
			exit
		else
			echo "PREFIX = $4" >> configure.def
			PREFIX_DEFINED_AT="3"
		fi
	else
		echo "PATH1 = $3" >> configure.def
	fi



	if test "$4" = "--prefix";
	then
		if test "$#" = "4" ;
		then
			echo " Missing parameters! "
			exit
		else
			echo "PREFIX = $5" >> configure.def
			PREFIX_DEFINED_AT="4"
		fi
	else
		if test "$PREFIX_DEFINED_AT" = "-1";
		then
			echo "PATH2 = $4" >> configure.def
		fi
	fi



	if test "$5" = "--prefix";
	then
		if test "$#" = "5" ;
		then
			echo " Missing parameters! "
			exit
		else
			echo "PREFIX = $6" >> configure.def
			PREFIX_DEFINED_AT="5"
		fi
	else
		if test "$PREFIX_DEFINED_AT" = "-1";
		then
			echo "PATH3 = $5" >> configure.def
		fi
	fi



	if test "$6" = "--prefix";
	then
		if test "$#" = "6" ;
		then
			echo " Missing parameters! "
			exit
		else
			echo "PREFIX = $7" >> configure.def
		fi
	else
		if test "$PREFIX_DEFINED_AT" = "-1";
		then
			echo "PATH4 = $6" >> configure.def
		fi
	fi

	fi
fi

if test "$1" = "--prefix";
then
	if test "$#" = "1" ;
	then
		echo " Missing parameters! "
		exit
	else
		if test "$2" = "--includedir" ;
		then
			echo " Missing prefix parameters! "
			exit
		else
			echo "PREFIX = $2" >> configure.def
		fi
	fi


	if test "$3" = "--includedir";
	then
		echo "PATH0 = $4" >> configure.def
		echo "PATH1 = $5" >> configure.def
		echo "PATH2 = $6" >> configure.def
		echo "PATH3 = $7" >> configure.def
		echo "PATH4 = $8" >> configure.def
	fi

fi










######################### QT Env variables checking
#
if  export | grep "$QTDIR" -q ;
then
	RES="yes"
else
	RES="no"
fi

echo Checking for QT library    ........    $RES   , $QTDIR

if echo $RES | grep "no" -q ;
then
	echo
	echo __ Probably your QT libraries arent set correctly or you havent
	echo __ already set the QT environment variables.
	echo __ Please see at http://www.trolltech.com for more info
	exit
fi

######################### qmake, uic, moc checking
#
if test -e $QTDIR/bin/qmake ;
then
	RES="yes"
else
	RES="no"
fi

echo Checking for qmake    ........    $RES

if test "$RES" = "no" ;
then
	echo
	echo __ I cant locate qmake. Just tried: $QTDIR/bin/qmake
	exit
fi

if test -e $QTDIR/bin/uic ;
then
	RES="yes"
else
	RES="no"
fi

echo Checking for uic    ........    $RES

if test "$RES" = "no" ;
then
	echo
	echo __ I cant locate uic. Just tried: $QTDIR/bin/uic
	exit
fi

if test -e $QTDIR/bin/moc ;
then
	RES="yes"
else
	RES="no"
fi

echo Checking for moc    ........    $RES

if test "$RES" = "no" ;
then
	echo
	echo __ I cant locate moc. Just tried: $QTDIR/bin/moc
	exit
fi


echo "-------------------------------------------"
echo    Now going with qmake...
echo "-------------------------------------------"

qmake mixxx.pro

