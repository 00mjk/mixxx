<!--
Description:
  The Library container.
  Left: Preview deck, CoverArt and Tree view (collapsible)
  Right: Tracks table.
-->
<Template>
  <SingletonDefinition>
    <ObjectName>Library_BreadCrumb_SearchBox_Row_Singleton</ObjectName>
    <Children>
      <WidgetGroup>
        <SizePolicy>me,min</SizePolicy>
        <Layout>horizontal</Layout>
        <Children>
          <!-- Show expand toggle if PreviewDeck is hidden,
              otherwise it shows up above Sidebar buttons -->
          <WidgetGroup>
            <ObjectName>AlignHCenter</ObjectName>
            <Layout>horizontal</Layout>
            <Size>37f,28min</Size>
            <Children>
              <Template src="skin:button_2state_persist.xml">
                <SetVariable name="ObjectName">LibMiniMaxiButton</SetVariable>
                <SetVariable name="Size">22f,28f</SetVariable>
                <SetVariable name="ConfigKey">[Master],maximize_library</SetVariable>
              </Template>
            </Children>
            <Connection>
              <ConfigKey persist="true">[PreviewDeck],show_previewdeck</ConfigKey>
              <Transform><Not/></Transform>
              <BindProperty>visible</BindProperty>
            </Connection>
          </WidgetGroup>

          <WidgetGroup>
            <SizePolicy>min,min</SizePolicy>
            <Layout>horizontal</Layout>
            <Children>
              <LibraryBreadCrumb>
                <ObjectName>LibraryBreadCrumb</ObjectName>
                <Id>1</Id>
              </LibraryBreadCrumb>
            </Children>
          </WidgetGroup>

          <WidgetGroup>
            <SizePolicy>min,min</SizePolicy>
            <Layout>horizontal</Layout>
            <Children>
              <SearchBox>
                <Id>1</Id>
              </SearchBox>
            </Children>
          </WidgetGroup>
        </Children>
      </WidgetGroup>
    </Children>
  </SingletonDefinition>

  <WidgetGroup>
<!-- Finally fixed: library can shrink to noting!
    Solution was to define SizePolicy as 'xx,i'.
    Found this in Deere-2.1 -->
    <ObjectName>Library</ObjectName>
    <SizePolicy>me,i</SizePolicy>
    <Layout>vertical</Layout>
    <Children>

      <WidgetGroup>
        <Size>1me,2f</Size>
        <Connection>
          <ConfigKey persist="true">[Master],maximize_library</ConfigKey>
          <BindProperty>visible</BindProperty>
        </Connection>
      </WidgetGroup>

      <!-- Library buttons + Breadcrumbs + SearchBox
          uses full width above Library if PreviewDeck is hidden -->
      <SingletonContainer>
        <ObjectName>Library_BreadCrumb_SearchBox_Row_Singleton</ObjectName>
        <Connection>
          <ConfigKey persist="true">[PreviewDeck],show_previewdeck</ConfigKey>
          <Transform><Not/></Transform>
          <BindProperty>visible</BindProperty>
        </Connection>
      </SingletonContainer>

      <Splitter><!-- Library -->
        <ObjectName>LibrarySplitter</ObjectName>
        <SizePolicy>me,me</SizePolicy>
        <SplitSizes>1,6</SplitSizes>
        <SplitSizesConfigKey>[Tango],lib_cover_feature_splitter</SplitSizesConfigKey>
        <Orientation>horizontal</Orientation>
        <Collapsible>1,0</Collapsible>
        <Children>

          <!-- SidebarButtons + [Preview + FeaturePane + CoverArt] -->
          <WidgetGroup>
            <Layout>horizontal</Layout>
            <Children>

              <WidgetGroup>
                <ObjectName>SidebarButtonsContainer</ObjectName>
                <SizePolicy>min,min</SizePolicy>
                <Layout>vertical</Layout>
                <Children>
                  <!-- Show expand toggle above Sidebar buttons
                  if PreviewDeck is hidden -->
                  <WidgetGroup>
                    <Layout>horizontal</Layout>
                    <Children>
                      <Template src="skin:button_2state_persist.xml">
                        <SetVariable name="ObjectName">LibMiniMaxiButton</SetVariable>
                        <SetVariable name="Size">22f,28f</SetVariable>
                        <SetVariable name="ConfigKey">[Master],maximize_library</SetVariable>
                      </Template>
                    </Children>
                    <Connection>
                      <ConfigKey persist="true">[PreviewDeck],show_previewdeck</ConfigKey>
                      <BindProperty>visible</BindProperty>
                    </Connection>
                  </WidgetGroup>

                  <LibrarySidebarButtons>
                    <SizePolicy>min,me</SizePolicy>
                    <ObjectName>LibrarySidebarButtons</ObjectName>
                  </LibrarySidebarButtons>
                </Children>
              </WidgetGroup>

              <WidgetGroup><!-- Preview + FeaturePane + CoverArt -->
                <Layout>vertical</Layout>
                <!-- minSize so that 8 Preview HotCues fit nicely, 23+1px each -->
                <Size>159min,74me</Size>
                <Children>

                  <Template src="skin:preview_deck.xml"/>

                  <WidgetGroup>
                    <Size>0min,5f</Size>
                    <Connection>
                      <ConfigKey persist="true">[PreviewDeck],show_previewdeck</ConfigKey>
                      <BindProperty>visible</BindProperty>
                    </Connection>
                  </WidgetGroup>

                  <Splitter><!-- Splitter to make CoverArt resizeable -->
                    <ObjectName>LibrarySplitter</ObjectName>
                    <SizePolicy>me,me</SizePolicy>
                    <SplitSizes>1,3</SplitSizes>
                    <SplitSizesConfigKey>[Tango],splitter__coverArt_tree</SplitSizesConfigKey>
                    <Orientation>vertical</Orientation>
                    <Collapsible>0,1</Collapsible>
                    <Children>
                      <LibrarySidebarExpanded>
                        <ObjectName>LibrarySidebarExpanded</ObjectName>
                        <Id>1</Id>
                      </LibrarySidebarExpanded>

                      <CoverArt>
                        <Size>30min,30min</Size>
                        <Connection>
                          <ConfigKey persist="true">[Library],show_coverart</ConfigKey>
                          <BindProperty>visible</BindProperty>
                        </Connection>
                      </CoverArt>
                    </Children>
                  </Splitter><!-- /Splitter to make CoverArt resizeable -->

                </Children>
              </WidgetGroup><!-- /Preview + FeaturePane + CoverArt -->

            </Children>
          </WidgetGroup><!-- SidebarButtons + [Preview + FeaturePane + CoverArt] -->

          <WidgetGroup>
            <SizePolicy>me,min</SizePolicy>
            <Layout>vertical</Layout>
            <Children>
              <!-- Library buttons + Breadcrumbs + SearchBox
                  above Tracks table if PreviewDeck is visible -->
              <SingletonContainer>
                <ObjectName>Library_BreadCrumb_SearchBox_Row_Singleton</ObjectName>
                <Connection>
                  <ConfigKey persist="true">[PreviewDeck],show_previewdeck</ConfigKey>
                  <BindProperty>visible</BindProperty>
                </Connection>
              </SingletonContainer>

              <LibraryPane>
                <BgColor>#585858</BgColor>
                <FgColor>#eece33</FgColor>
                <Id>1</Id>
              </LibraryPane>
            </Children>
          </WidgetGroup>

        </Children>
      </Splitter><!-- /Split Tree / Tracks table -->

    </Children>
    <Connection>
      <ConfigKey persist="true">[Library],show_library</ConfigKey>
      <BindProperty>visible</BindProperty>
    </Connection>
  </WidgetGroup>
</Template>
